"use strict";/*
 * Copyright The OpenTelemetry Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cov_14ftmralbh(){var path="/Users/zocong/Documents/forked/opentelemetry-js-contrib/propagators/opentelemetry-propagator-aws-xray/src/AWSXRayPropagator.ts";var hash="772fbec604669e06dc296ccd9e303b58e6f1f74e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/zocong/Documents/forked/opentelemetry-js-contrib/propagators/opentelemetry-propagator-aws-xray/src/AWSXRayPropagator.ts",statementMap:{"0":{start:{line:17,column:0},end:{line:17,column:62}},"1":{start:{line:18,column:0},end:{line:18,column:69}},"2":{start:{line:19,column:14},end:{line:19,column:43}},"3":{start:{line:20,column:15},end:{line:20,column:45}},"4":{start:{line:21,column:0},end:{line:21,column:52}},"5":{start:{line:22,column:31},end:{line:22,column:34}},"6":{start:{line:23,column:21},end:{line:23,column:24}},"7":{start:{line:24,column:21},end:{line:24,column:27}},"8":{start:{line:25,column:24},end:{line:25,column:26}},"9":{start:{line:26,column:25},end:{line:26,column:28}},"10":{start:{line:27,column:27},end:{line:27,column:30}},"11":{start:{line:28,column:35},end:{line:28,column:36}},"12":{start:{line:29,column:35},end:{line:29,column:37}},"13":{start:{line:30,column:35},end:{line:30,column:36}},"14":{start:{line:31,column:22},end:{line:31,column:30}},"15":{start:{line:32,column:25},end:{line:32,column:27}},"16":{start:{line:33,column:25},end:{line:33,column:34}},"17":{start:{line:34,column:28},end:{line:34,column:29}},"18":{start:{line:35,column:19},end:{line:35,column:22}},"19":{start:{line:36,column:20},end:{line:36,column:23}},"20":{start:{line:37,column:28},end:{line:37,column:47}},"21":{start:{line:38,column:27},end:{line:38,column:44}},"22":{start:{line:49,column:28},end:{line:49,column:64}},"23":{start:{line:50,column:8},end:{line:51,column:19}},"24":{start:{line:51,column:12},end:{line:51,column:19}},"25":{start:{line:52,column:8},end:{line:56,column:19}},"26":{start:{line:56,column:12},end:{line:56,column:19}},"27":{start:{line:57,column:26},end:{line:57,column:45}},"28":{start:{line:58,column:28},end:{line:62,column:61}},"29":{start:{line:63,column:25},end:{line:63,column:43}},"30":{start:{line:64,column:29},end:{line:64,column:78}},"31":{start:{line:66,column:28},end:{line:76,column:26}},"32":{start:{line:77,column:8},end:{line:77,column:70}},"33":{start:{line:80,column:28},end:{line:80,column:74}},"34":{start:{line:81,column:8},end:{line:82,column:27}},"35":{start:{line:82,column:12},end:{line:82,column:27}},"36":{start:{line:83,column:8},end:{line:83,column:68}},"37":{start:{line:86,column:28},end:{line:86,column:76}},"38":{start:{line:88,column:8},end:{line:89,column:47}},"39":{start:{line:89,column:12},end:{line:89,column:47}},"40":{start:{line:90,column:18},end:{line:90,column:19}},"41":{start:{line:91,column:28},end:{line:91,column:50}},"42":{start:{line:92,column:27},end:{line:92,column:48}},"43":{start:{line:93,column:31},end:{line:93,column:35}},"44":{start:{line:94,column:8},end:{line:116,column:9}},"45":{start:{line:95,column:35},end:{line:95,column:83}},"46":{start:{line:96,column:12},end:{line:104,column:13}},"47":{start:{line:97,column:16},end:{line:97,column:80}},"48":{start:{line:98,column:16},end:{line:98,column:41}},"49":{start:{line:102,column:16},end:{line:102,column:64}},"50":{start:{line:103,column:16},end:{line:103,column:41}},"51":{start:{line:105,column:32},end:{line:105,column:65}},"52":{start:{line:106,column:26},end:{line:106,column:64}},"53":{start:{line:107,column:12},end:{line:109,column:13}},"54":{start:{line:108,column:16},end:{line:108,column:58}},"55":{start:{line:110,column:12},end:{line:112,column:13}},"56":{start:{line:111,column:16},end:{line:111,column:56}},"57":{start:{line:113,column:12},end:{line:115,column:13}},"58":{start:{line:114,column:16},end:{line:114,column:63}},"59":{start:{line:117,column:8},end:{line:119,column:9}},"60":{start:{line:118,column:12},end:{line:118,column:47}},"61":{start:{line:120,column:34},end:{line:125,column:9}},"62":{start:{line:126,column:8},end:{line:128,column:9}},"63":{start:{line:127,column:12},end:{line:127,column:47}},"64":{start:{line:129,column:8},end:{line:129,column:33}},"65":{start:{line:133,column:8},end:{line:135,column:9}},"66":{start:{line:134,column:12},end:{line:134,column:42}},"67":{start:{line:137,column:8},end:{line:139,column:9}},"68":{start:{line:138,column:12},end:{line:138,column:42}},"69":{start:{line:141,column:8},end:{line:144,column:9}},"70":{start:{line:143,column:12},end:{line:143,column:42}},"71":{start:{line:145,column:26},end:{line:145,column:107}},"72":{start:{line:146,column:27},end:{line:146,column:97}},"73":{start:{line:147,column:27},end:{line:147,column:49}},"74":{start:{line:149,column:8},end:{line:151,column:9}},"75":{start:{line:150,column:12},end:{line:150,column:42}},"76":{start:{line:152,column:8},end:{line:152,column:26}},"77":{start:{line:155,column:8},end:{line:156,column:90}},"78":{start:{line:159,column:8},end:{line:167,column:9}},"79":{start:{line:160,column:12},end:{line:160,column:41}},"80":{start:{line:162,column:13},end:{line:167,column:9}},"81":{start:{line:163,column:12},end:{line:163,column:44}},"82":{start:{line:166,column:12},end:{line:166,column:24}},"83":{start:{line:170,column:0},end:{line:170,column:46}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:48,column:4},end:{line:48,column:5}},loc:{start:{line:48,column:37},end:{line:78,column:5}},line:48},"1":{name:"(anonymous_1)",decl:{start:{line:79,column:4},end:{line:79,column:5}},loc:{start:{line:79,column:38},end:{line:84,column:5}},line:79},"2":{name:"(anonymous_2)",decl:{start:{line:85,column:4},end:{line:85,column:5}},loc:{start:{line:85,column:46},end:{line:130,column:5}},line:85},"3":{name:"(anonymous_3)",decl:{start:{line:131,column:4},end:{line:131,column:5}},loc:{start:{line:131,column:31},end:{line:153,column:5}},line:131},"4":{name:"(anonymous_4)",decl:{start:{line:154,column:4},end:{line:154,column:5}},loc:{start:{line:154,column:31},end:{line:157,column:5}},line:154},"5":{name:"(anonymous_5)",decl:{start:{line:158,column:4},end:{line:158,column:5}},loc:{start:{line:158,column:37},end:{line:168,column:5}},line:158}},branchMap:{"0":{loc:{start:{line:50,column:8},end:{line:51,column:19}},type:"if",locations:[{start:{line:50,column:8},end:{line:51,column:19}},{start:{line:50,column:8},end:{line:51,column:19}}],line:50},"1":{loc:{start:{line:50,column:12},end:{line:50,column:56}},type:"binary-expr",locations:[{start:{line:50,column:12},end:{line:50,column:24}},{start:{line:50,column:28},end:{line:50,column:56}}],line:50},"2":{loc:{start:{line:52,column:8},end:{line:56,column:19}},type:"if",locations:[{start:{line:52,column:8},end:{line:56,column:19}},{start:{line:52,column:8},end:{line:56,column:19}}],line:52},"3":{loc:{start:{line:52,column:12},end:{line:55,column:68}},type:"binary-expr",locations:[{start:{line:52,column:12},end:{line:52,column:58}},{start:{line:53,column:12},end:{line:53,column:56}},{start:{line:54,column:12},end:{line:55,column:68}}],line:52},"4":{loc:{start:{line:54,column:14},end:{line:55,column:67}},type:"binary-expr",locations:[{start:{line:54,column:14},end:{line:54,column:62}},{start:{line:55,column:16},end:{line:55,column:67}}],line:54},"5":{loc:{start:{line:64,column:29},end:{line:64,column:78}},type:"cond-expr",locations:[{start:{line:64,column:54},end:{line:64,column:64}},{start:{line:64,column:67},end:{line:64,column:78}}],line:64},"6":{loc:{start:{line:81,column:8},end:{line:82,column:27}},type:"if",locations:[{start:{line:81,column:8},end:{line:82,column:27}},{start:{line:81,column:8},end:{line:82,column:27}}],line:81},"7":{loc:{start:{line:88,column:8},end:{line:89,column:47}},type:"if",locations:[{start:{line:88,column:8},end:{line:89,column:47}},{start:{line:88,column:8},end:{line:89,column:47}}],line:88},"8":{loc:{start:{line:88,column:12},end:{line:88,column:59}},type:"binary-expr",locations:[{start:{line:88,column:12},end:{line:88,column:24}},{start:{line:88,column:28},end:{line:88,column:59}}],line:88},"9":{loc:{start:{line:96,column:12},end:{line:104,column:13}},type:"if",locations:[{start:{line:96,column:12},end:{line:104,column:13}},{start:{line:96,column:12},end:{line:104,column:13}}],line:96},"10":{loc:{start:{line:107,column:12},end:{line:109,column:13}},type:"if",locations:[{start:{line:107,column:12},end:{line:109,column:13}},{start:{line:107,column:12},end:{line:109,column:13}}],line:107},"11":{loc:{start:{line:110,column:12},end:{line:112,column:13}},type:"if",locations:[{start:{line:110,column:12},end:{line:112,column:13}},{start:{line:110,column:12},end:{line:112,column:13}}],line:110},"12":{loc:{start:{line:113,column:12},end:{line:115,column:13}},type:"if",locations:[{start:{line:113,column:12},end:{line:115,column:13}},{start:{line:113,column:12},end:{line:115,column:13}}],line:113},"13":{loc:{start:{line:117,column:8},end:{line:119,column:9}},type:"if",locations:[{start:{line:117,column:8},end:{line:119,column:9}},{start:{line:117,column:8},end:{line:119,column:9}}],line:117},"14":{loc:{start:{line:126,column:8},end:{line:128,column:9}},type:"if",locations:[{start:{line:126,column:8},end:{line:128,column:9}},{start:{line:126,column:8},end:{line:128,column:9}}],line:126},"15":{loc:{start:{line:133,column:8},end:{line:135,column:9}},type:"if",locations:[{start:{line:133,column:8},end:{line:135,column:9}},{start:{line:133,column:8},end:{line:135,column:9}}],line:133},"16":{loc:{start:{line:137,column:8},end:{line:139,column:9}},type:"if",locations:[{start:{line:137,column:8},end:{line:139,column:9}},{start:{line:137,column:8},end:{line:139,column:9}}],line:137},"17":{loc:{start:{line:141,column:8},end:{line:144,column:9}},type:"if",locations:[{start:{line:141,column:8},end:{line:144,column:9}},{start:{line:141,column:8},end:{line:144,column:9}}],line:141},"18":{loc:{start:{line:141,column:12},end:{line:142,column:84}},type:"binary-expr",locations:[{start:{line:141,column:12},end:{line:141,column:81}},{start:{line:142,column:15},end:{line:142,column:84}}],line:141},"19":{loc:{start:{line:149,column:8},end:{line:151,column:9}},type:"if",locations:[{start:{line:149,column:8},end:{line:151,column:9}},{start:{line:149,column:8},end:{line:151,column:9}}],line:149},"20":{loc:{start:{line:155,column:15},end:{line:156,column:89}},type:"cond-expr",locations:[{start:{line:156,column:53},end:{line:156,column:65}},{start:{line:156,column:68},end:{line:156,column:89}}],line:155},"21":{loc:{start:{line:155,column:16},end:{line:156,column:49}},type:"binary-expr",locations:[{start:{line:155,column:16},end:{line:155,column:56}},{start:{line:156,column:12},end:{line:156,column:49}}],line:155},"22":{loc:{start:{line:159,column:8},end:{line:167,column:9}},type:"if",locations:[{start:{line:159,column:8},end:{line:167,column:9}},{start:{line:159,column:8},end:{line:167,column:9}}],line:159},"23":{loc:{start:{line:159,column:12},end:{line:159,column:93}},type:"binary-expr",locations:[{start:{line:159,column:12},end:{line:159,column:58}},{start:{line:159,column:62},end:{line:159,column:93}}],line:159},"24":{loc:{start:{line:162,column:13},end:{line:167,column:9}},type:"if",locations:[{start:{line:162,column:13},end:{line:167,column:9}},{start:{line:162,column:13},end:{line:167,column:9}}],line:162}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},inputSourceMap:{version:3,file:"/Users/zocong/Documents/forked/opentelemetry-js-contrib/propagators/opentelemetry-propagator-aws-xray/src/AWSXRayPropagator.ts",sources:["/Users/zocong/Documents/forked/opentelemetry-js-contrib/propagators/opentelemetry-propagator-aws-xray/src/AWSXRayPropagator.ts"],names:[],mappings:"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",sourcesContent:["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Context,\n  HttpTextPropagator,\n  SpanContext,\n  TraceFlags,\n  SetterFunction,\n  GetterFunction,\n  INVALID_TRACE_ID,\n  INVALID_SPAN_ID,\n} from '@opentelemetry/api';\nimport {\n  getParentSpanContext,\n  setExtractedSpanContext,\n  INVALID_SPAN_CONTEXT,\n  isValid,\n} from '@opentelemetry/core';\n\nexport const AWSXRAY_TRACE_ID_HEADER = 'X-Amzn-Trace-Id';\n\nconst TRACE_HEADER_DELIMITER = ';';\nconst KV_DELIMITER = '=';\n\nconst TRACE_ID_KEY = 'Root';\nconst TRACE_ID_LENGTH = 35;\nconst TRACE_ID_VERSION = \"1\";\nconst TRACE_ID_DELIMITER = '-';\nconst TRACE_ID_DELIMITER_INDEX_1 = 1;\nconst TRACE_ID_DELIMITER_INDEX_2 = 10;\nconst TRACE_ID_FIRST_PART_LENGTH = 8;\n\nconst PARENT_ID_KEY = 'Parent';\nconst PARENT_ID_LENGTH = 16;\n\nconst SAMPLED_FLAG_KEY = 'Sampled';\nconst SAMPLED_FLAG_LENGTH = 1;\nconst IS_SAMPLED = '1';\nconst NOT_SAMPLED = '0';\n\nconst VALID_TRACEID_REGEX = /^([0-9a-f]{32})$/i;\nconst VALID_SPANID_REGEX = /^[0-9a-f]{16}$/i;\n/**\n * Implementation of the AWS X-Ray Trace Header propagation protocol. See <a href=\n * https://https://docs.aws.amazon.com/xray/latest/devguide/xray-concepts.html#xray-concepts-tracingheader>AWS\n * Tracing header spec</a>\n * \n * An example AWS Xray Tracing Header is shown below:\n * X-Amzn-Trace-Id: Root=1-5759e988-bd862e3fe1be46a994272793;Parent=53995c3f42cd8ad8;Sampled=1\n */\nexport class AWSXRayPropagator implements HttpTextPropagator {\n  inject(context: Context, carrier: unknown, setter: SetterFunction) {\n    const spanContext = getParentSpanContext(context);\n    if (!spanContext || !isValid(spanContext)) return;\n    if (!VALID_TRACEID_REGEX.test(spanContext.traceId) ||\n      !VALID_SPANID_REGEX.test(spanContext.spanId) ||\n      !(spanContext.traceFlags !== TraceFlags.NONE &&\n        spanContext.traceFlags !== TraceFlags.SAMPLED)) return;\n\n    const otTraceId = spanContext.traceId;\n    const xrayTraceId = TRACE_ID_VERSION\n      + TRACE_ID_DELIMITER\n      + otTraceId.substring(0, TRACE_ID_FIRST_PART_LENGTH)\n      + TRACE_ID_DELIMITER\n      + otTraceId.substring(TRACE_ID_FIRST_PART_LENGTH);\n    const parentId = spanContext.spanId;\n    const samplingFlag = spanContext.traceFlags? IS_SAMPLED: NOT_SAMPLED;\n    // TODO: Add OT trace state to the X-Ray trace header\n\n    const traceHeader = TRACE_ID_KEY\n      + KV_DELIMITER\n      + xrayTraceId\n      + TRACE_HEADER_DELIMITER\n      + PARENT_ID_KEY\n      + KV_DELIMITER\n      + parentId\n      + TRACE_HEADER_DELIMITER\n      + SAMPLED_FLAG_KEY\n      + KV_DELIMITER\n      + samplingFlag;\n\n    setter(\n      carrier,\n      AWSXRAY_TRACE_ID_HEADER,\n      traceHeader\n    );\n  }\n\n  extract(context: Context, carrier: unknown, getter: GetterFunction): Context {\n    const spanContext = this.getSpanContextFromHeader(carrier, getter);\n    if (!isValid(spanContext)) return context;\n\n    return setExtractedSpanContext(context, spanContext);\n  }\n  \n  private getSpanContextFromHeader(carrier: unknown, getter: GetterFunction): SpanContext {\n    const traceHeader = getter(carrier, AWSXRAY_TRACE_ID_HEADER);\n    // Only if the returned traceHeader is no empty string can be extracted\n    if (!traceHeader || typeof traceHeader !== 'string') return INVALID_SPAN_CONTEXT;\n\n    let pos = 0, trimmedPart: string;\n    let parsedTraceId = INVALID_TRACE_ID;\n    let parsedSpanId = INVALID_SPAN_ID;\n    let parsedTraceFlags = null;\n    while(pos < traceHeader.length) {\n      const delimiterIndex = traceHeader.indexOf(TRACE_HEADER_DELIMITER, pos);\n      if (delimiterIndex >= 0) {\n        trimmedPart = traceHeader.substring(pos, delimiterIndex).trim();\n        pos = delimiterIndex + 1;\n      } else {\n        //last part\n        trimmedPart = traceHeader.substring(pos).trim();\n        pos = traceHeader.length;\n      }\n      const equalsIndex = trimmedPart.indexOf(KV_DELIMITER);\n\n      const value = trimmedPart.substring(equalsIndex + 1);\n\n      if (trimmedPart.startsWith(TRACE_ID_KEY)) {\n        parsedTraceId = this._parseTraceId(value);\n      }\n      if (trimmedPart.startsWith(PARENT_ID_KEY)) {\n        parsedSpanId = this._parseSpanId(value);\n      }\n      if (trimmedPart.startsWith(SAMPLED_FLAG_KEY)) {\n        parsedTraceFlags = this._parseTraceFlag(value);\n      }\n    }\n    if (parsedTraceFlags === null) {\n      return INVALID_SPAN_CONTEXT;\n    }\n    const resultSpanContext: SpanContext = {\n      traceId: parsedTraceId,\n      spanId: parsedSpanId,\n      traceFlags: parsedTraceFlags,\n      isRemote: true,\n    }\n    if (!isValid(resultSpanContext)) {\n      return INVALID_SPAN_CONTEXT;\n    }\n    return resultSpanContext;\n  }\n\n  private _parseTraceId(xrayTraceId: string): string {\n    // Check length of trace id\n    if (xrayTraceId.length !== TRACE_ID_LENGTH) {\n      return INVALID_TRACE_ID;\n    }\n\n    // Check version trace id version\n    if (!xrayTraceId.startsWith(TRACE_ID_VERSION)) {\n      return INVALID_TRACE_ID;\n    }\n\n    // Check delimiters\n    if (xrayTraceId.charAt(TRACE_ID_DELIMITER_INDEX_1) !== TRACE_ID_DELIMITER\n    || xrayTraceId.charAt(TRACE_ID_DELIMITER_INDEX_2) !== TRACE_ID_DELIMITER) {\n      return INVALID_TRACE_ID;\n    }\n\n    const epochPart = xrayTraceId.substring(TRACE_ID_DELIMITER_INDEX_1 + 1, TRACE_ID_DELIMITER_INDEX_2);\n    const uniquePart = xrayTraceId.substring(TRACE_ID_DELIMITER_INDEX_2 + 1, TRACE_ID_LENGTH);\n    const resTraceId = epochPart + uniquePart;\n\n    // Check the content of trace id\n    if (!VALID_TRACEID_REGEX.test(resTraceId)) {\n      return INVALID_TRACE_ID\n    }\n\n    return resTraceId;\n  }\n\n  private _parseSpanId(xrayParentId: string): string{\n    return (xrayParentId.length === PARENT_ID_LENGTH && \n      VALID_SPANID_REGEX.test(xrayParentId))? xrayParentId: INVALID_SPAN_ID;\n  }\n\n  private _parseTraceFlag(xraySampledFlag: string): TraceFlags | null {\n    if (xraySampledFlag.length === SAMPLED_FLAG_LENGTH && xraySampledFlag === NOT_SAMPLED) {\n      return TraceFlags.NONE;\n    } else if (xraySampledFlag === IS_SAMPLED) {\n      return TraceFlags.SAMPLED;\n    } else {\n      return null;\n    }\n  }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"772fbec604669e06dc296ccd9e303b58e6f1f74e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_14ftmralbh=function(){return actualCoverage;};}return actualCoverage;}cov_14ftmralbh();cov_14ftmralbh().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_14ftmralbh().s[1]++;exports.AWSXRayPropagator=exports.AWSXRAY_TRACE_ID_HEADER=void 0;const api_1=(cov_14ftmralbh().s[2]++,require("@opentelemetry/api"));const core_1=(cov_14ftmralbh().s[3]++,require("@opentelemetry/core"));cov_14ftmralbh().s[4]++;exports.AWSXRAY_TRACE_ID_HEADER='X-Amzn-Trace-Id';const TRACE_HEADER_DELIMITER=(cov_14ftmralbh().s[5]++,';');const KV_DELIMITER=(cov_14ftmralbh().s[6]++,'=');const TRACE_ID_KEY=(cov_14ftmralbh().s[7]++,'Root');const TRACE_ID_LENGTH=(cov_14ftmralbh().s[8]++,35);const TRACE_ID_VERSION=(cov_14ftmralbh().s[9]++,"1");const TRACE_ID_DELIMITER=(cov_14ftmralbh().s[10]++,'-');const TRACE_ID_DELIMITER_INDEX_1=(cov_14ftmralbh().s[11]++,1);const TRACE_ID_DELIMITER_INDEX_2=(cov_14ftmralbh().s[12]++,10);const TRACE_ID_FIRST_PART_LENGTH=(cov_14ftmralbh().s[13]++,8);const PARENT_ID_KEY=(cov_14ftmralbh().s[14]++,'Parent');const PARENT_ID_LENGTH=(cov_14ftmralbh().s[15]++,16);const SAMPLED_FLAG_KEY=(cov_14ftmralbh().s[16]++,'Sampled');const SAMPLED_FLAG_LENGTH=(cov_14ftmralbh().s[17]++,1);const IS_SAMPLED=(cov_14ftmralbh().s[18]++,'1');const NOT_SAMPLED=(cov_14ftmralbh().s[19]++,'0');const VALID_TRACEID_REGEX=(cov_14ftmralbh().s[20]++,/^([0-9a-f]{32})$/i);const VALID_SPANID_REGEX=(cov_14ftmralbh().s[21]++,/^[0-9a-f]{16}$/i);/**
 * Implementation of the AWS X-Ray Trace Header propagation protocol. See <a href=
 * https://https://docs.aws.amazon.com/xray/latest/devguide/xray-concepts.html#xray-concepts-tracingheader>AWS
 * Tracing header spec</a>
 *
 * An example AWS Xray Tracing Header is shown below:
 * X-Amzn-Trace-Id: Root=1-5759e988-bd862e3fe1be46a994272793;Parent=53995c3f42cd8ad8;Sampled=1
 */class AWSXRayPropagator{inject(context,carrier,setter){cov_14ftmralbh().f[0]++;const spanContext=(cov_14ftmralbh().s[22]++,core_1.getParentSpanContext(context));cov_14ftmralbh().s[23]++;if((cov_14ftmralbh().b[1][0]++,!spanContext)||(cov_14ftmralbh().b[1][1]++,!core_1.isValid(spanContext))){cov_14ftmralbh().b[0][0]++;cov_14ftmralbh().s[24]++;return;}else{cov_14ftmralbh().b[0][1]++;}cov_14ftmralbh().s[25]++;if((cov_14ftmralbh().b[3][0]++,!VALID_TRACEID_REGEX.test(spanContext.traceId))||(cov_14ftmralbh().b[3][1]++,!VALID_SPANID_REGEX.test(spanContext.spanId))||(cov_14ftmralbh().b[3][2]++,!((cov_14ftmralbh().b[4][0]++,spanContext.traceFlags!==api_1.TraceFlags.NONE)&&(cov_14ftmralbh().b[4][1]++,spanContext.traceFlags!==api_1.TraceFlags.SAMPLED)))){cov_14ftmralbh().b[2][0]++;cov_14ftmralbh().s[26]++;return;}else{cov_14ftmralbh().b[2][1]++;}const otTraceId=(cov_14ftmralbh().s[27]++,spanContext.traceId);const xrayTraceId=(cov_14ftmralbh().s[28]++,TRACE_ID_VERSION+TRACE_ID_DELIMITER+otTraceId.substring(0,TRACE_ID_FIRST_PART_LENGTH)+TRACE_ID_DELIMITER+otTraceId.substring(TRACE_ID_FIRST_PART_LENGTH));const parentId=(cov_14ftmralbh().s[29]++,spanContext.spanId);const samplingFlag=(cov_14ftmralbh().s[30]++,spanContext.traceFlags?(cov_14ftmralbh().b[5][0]++,IS_SAMPLED):(cov_14ftmralbh().b[5][1]++,NOT_SAMPLED));// TODO: Add OT trace state to the X-Ray trace header
const traceHeader=(cov_14ftmralbh().s[31]++,TRACE_ID_KEY+KV_DELIMITER+xrayTraceId+TRACE_HEADER_DELIMITER+PARENT_ID_KEY+KV_DELIMITER+parentId+TRACE_HEADER_DELIMITER+SAMPLED_FLAG_KEY+KV_DELIMITER+samplingFlag);cov_14ftmralbh().s[32]++;setter(carrier,exports.AWSXRAY_TRACE_ID_HEADER,traceHeader);}extract(context,carrier,getter){cov_14ftmralbh().f[1]++;const spanContext=(cov_14ftmralbh().s[33]++,this.getSpanContextFromHeader(carrier,getter));cov_14ftmralbh().s[34]++;if(!core_1.isValid(spanContext)){cov_14ftmralbh().b[6][0]++;cov_14ftmralbh().s[35]++;return context;}else{cov_14ftmralbh().b[6][1]++;}cov_14ftmralbh().s[36]++;return core_1.setExtractedSpanContext(context,spanContext);}getSpanContextFromHeader(carrier,getter){cov_14ftmralbh().f[2]++;const traceHeader=(cov_14ftmralbh().s[37]++,getter(carrier,exports.AWSXRAY_TRACE_ID_HEADER));// Only if the returned traceHeader is no empty string can be extracted
cov_14ftmralbh().s[38]++;if((cov_14ftmralbh().b[8][0]++,!traceHeader)||(cov_14ftmralbh().b[8][1]++,typeof traceHeader!=='string')){cov_14ftmralbh().b[7][0]++;cov_14ftmralbh().s[39]++;return core_1.INVALID_SPAN_CONTEXT;}else{cov_14ftmralbh().b[7][1]++;}let pos=(cov_14ftmralbh().s[40]++,0),trimmedPart;let parsedTraceId=(cov_14ftmralbh().s[41]++,api_1.INVALID_TRACE_ID);let parsedSpanId=(cov_14ftmralbh().s[42]++,api_1.INVALID_SPAN_ID);let parsedTraceFlags=(cov_14ftmralbh().s[43]++,null);cov_14ftmralbh().s[44]++;while(pos<traceHeader.length){const delimiterIndex=(cov_14ftmralbh().s[45]++,traceHeader.indexOf(TRACE_HEADER_DELIMITER,pos));cov_14ftmralbh().s[46]++;if(delimiterIndex>=0){cov_14ftmralbh().b[9][0]++;cov_14ftmralbh().s[47]++;trimmedPart=traceHeader.substring(pos,delimiterIndex).trim();cov_14ftmralbh().s[48]++;pos=delimiterIndex+1;}else{cov_14ftmralbh().b[9][1]++;cov_14ftmralbh().s[49]++;//last part
trimmedPart=traceHeader.substring(pos).trim();cov_14ftmralbh().s[50]++;pos=traceHeader.length;}const equalsIndex=(cov_14ftmralbh().s[51]++,trimmedPart.indexOf(KV_DELIMITER));const value=(cov_14ftmralbh().s[52]++,trimmedPart.substring(equalsIndex+1));cov_14ftmralbh().s[53]++;if(trimmedPart.startsWith(TRACE_ID_KEY)){cov_14ftmralbh().b[10][0]++;cov_14ftmralbh().s[54]++;parsedTraceId=this._parseTraceId(value);}else{cov_14ftmralbh().b[10][1]++;}cov_14ftmralbh().s[55]++;if(trimmedPart.startsWith(PARENT_ID_KEY)){cov_14ftmralbh().b[11][0]++;cov_14ftmralbh().s[56]++;parsedSpanId=this._parseSpanId(value);}else{cov_14ftmralbh().b[11][1]++;}cov_14ftmralbh().s[57]++;if(trimmedPart.startsWith(SAMPLED_FLAG_KEY)){cov_14ftmralbh().b[12][0]++;cov_14ftmralbh().s[58]++;parsedTraceFlags=this._parseTraceFlag(value);}else{cov_14ftmralbh().b[12][1]++;}}cov_14ftmralbh().s[59]++;if(parsedTraceFlags===null){cov_14ftmralbh().b[13][0]++;cov_14ftmralbh().s[60]++;return core_1.INVALID_SPAN_CONTEXT;}else{cov_14ftmralbh().b[13][1]++;}const resultSpanContext=(cov_14ftmralbh().s[61]++,{traceId:parsedTraceId,spanId:parsedSpanId,traceFlags:parsedTraceFlags,isRemote:true});cov_14ftmralbh().s[62]++;if(!core_1.isValid(resultSpanContext)){cov_14ftmralbh().b[14][0]++;cov_14ftmralbh().s[63]++;return core_1.INVALID_SPAN_CONTEXT;}else{cov_14ftmralbh().b[14][1]++;}cov_14ftmralbh().s[64]++;return resultSpanContext;}_parseTraceId(xrayTraceId){cov_14ftmralbh().f[3]++;cov_14ftmralbh().s[65]++;// Check length of trace id
if(xrayTraceId.length!==TRACE_ID_LENGTH){cov_14ftmralbh().b[15][0]++;cov_14ftmralbh().s[66]++;return api_1.INVALID_TRACE_ID;}else{cov_14ftmralbh().b[15][1]++;}// Check version trace id version
cov_14ftmralbh().s[67]++;if(!xrayTraceId.startsWith(TRACE_ID_VERSION)){cov_14ftmralbh().b[16][0]++;cov_14ftmralbh().s[68]++;return api_1.INVALID_TRACE_ID;}else{cov_14ftmralbh().b[16][1]++;}// Check delimiters
cov_14ftmralbh().s[69]++;if((cov_14ftmralbh().b[18][0]++,xrayTraceId.charAt(TRACE_ID_DELIMITER_INDEX_1)!==TRACE_ID_DELIMITER)||(cov_14ftmralbh().b[18][1]++,xrayTraceId.charAt(TRACE_ID_DELIMITER_INDEX_2)!==TRACE_ID_DELIMITER)){cov_14ftmralbh().b[17][0]++;cov_14ftmralbh().s[70]++;return api_1.INVALID_TRACE_ID;}else{cov_14ftmralbh().b[17][1]++;}const epochPart=(cov_14ftmralbh().s[71]++,xrayTraceId.substring(TRACE_ID_DELIMITER_INDEX_1+1,TRACE_ID_DELIMITER_INDEX_2));const uniquePart=(cov_14ftmralbh().s[72]++,xrayTraceId.substring(TRACE_ID_DELIMITER_INDEX_2+1,TRACE_ID_LENGTH));const resTraceId=(cov_14ftmralbh().s[73]++,epochPart+uniquePart);// Check the content of trace id
cov_14ftmralbh().s[74]++;if(!VALID_TRACEID_REGEX.test(resTraceId)){cov_14ftmralbh().b[19][0]++;cov_14ftmralbh().s[75]++;return api_1.INVALID_TRACE_ID;}else{cov_14ftmralbh().b[19][1]++;}cov_14ftmralbh().s[76]++;return resTraceId;}_parseSpanId(xrayParentId){cov_14ftmralbh().f[4]++;cov_14ftmralbh().s[77]++;return(cov_14ftmralbh().b[21][0]++,xrayParentId.length===PARENT_ID_LENGTH)&&(cov_14ftmralbh().b[21][1]++,VALID_SPANID_REGEX.test(xrayParentId))?(cov_14ftmralbh().b[20][0]++,xrayParentId):(cov_14ftmralbh().b[20][1]++,api_1.INVALID_SPAN_ID);}_parseTraceFlag(xraySampledFlag){cov_14ftmralbh().f[5]++;cov_14ftmralbh().s[78]++;if((cov_14ftmralbh().b[23][0]++,xraySampledFlag.length===SAMPLED_FLAG_LENGTH)&&(cov_14ftmralbh().b[23][1]++,xraySampledFlag===NOT_SAMPLED)){cov_14ftmralbh().b[22][0]++;cov_14ftmralbh().s[79]++;return api_1.TraceFlags.NONE;}else{cov_14ftmralbh().b[22][1]++;cov_14ftmralbh().s[80]++;if(xraySampledFlag===IS_SAMPLED){cov_14ftmralbh().b[24][0]++;cov_14ftmralbh().s[81]++;return api_1.TraceFlags.SAMPLED;}else{cov_14ftmralbh().b[24][1]++;cov_14ftmralbh().s[82]++;return null;}}}}cov_14ftmralbh().s[83]++;exports.AWSXRayPropagator=AWSXRayPropagator;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3pvY29uZy9Eb2N1bWVudHMvZm9ya2VkL29wZW50ZWxlbWV0cnktanMtY29udHJpYi9wcm9wYWdhdG9ycy9vcGVudGVsZW1ldHJ5LXByb3BhZ2F0b3ItYXdzLXhyYXkvc3JjL0FXU1hSYXlQcm9wYWdhdG9yLnRzIiwic291cmNlcyI6WyIvVXNlcnMvem9jb25nL0RvY3VtZW50cy9mb3JrZWQvb3BlbnRlbGVtZXRyeS1qcy1jb250cmliL3Byb3BhZ2F0b3JzL29wZW50ZWxlbWV0cnktcHJvcGFnYXRvci1hd3MteHJheS9zcmMvQVdTWFJheVByb3BhZ2F0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7OztHQWNHOzs7QUFFSCw0Q0FTNEI7QUFDNUIsOENBSzZCO0FBRWhCLFFBQUEsdUJBQXVCLEdBQUcsaUJBQWlCLENBQUM7QUFFekQsTUFBTSxzQkFBc0IsR0FBRyxHQUFHLENBQUM7QUFDbkMsTUFBTSxZQUFZLEdBQUcsR0FBRyxDQUFDO0FBRXpCLE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQztBQUM1QixNQUFNLGVBQWUsR0FBRyxFQUFFLENBQUM7QUFDM0IsTUFBTSxnQkFBZ0IsR0FBRyxHQUFHLENBQUM7QUFDN0IsTUFBTSxrQkFBa0IsR0FBRyxHQUFHLENBQUM7QUFDL0IsTUFBTSwwQkFBMEIsR0FBRyxDQUFDLENBQUM7QUFDckMsTUFBTSwwQkFBMEIsR0FBRyxFQUFFLENBQUM7QUFDdEMsTUFBTSwwQkFBMEIsR0FBRyxDQUFDLENBQUM7QUFFckMsTUFBTSxhQUFhLEdBQUcsUUFBUSxDQUFDO0FBQy9CLE1BQU0sZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO0FBRTVCLE1BQU0sZ0JBQWdCLEdBQUcsU0FBUyxDQUFDO0FBQ25DLE1BQU0sbUJBQW1CLEdBQUcsQ0FBQyxDQUFDO0FBQzlCLE1BQU0sVUFBVSxHQUFHLEdBQUcsQ0FBQztBQUN2QixNQUFNLFdBQVcsR0FBRyxHQUFHLENBQUM7QUFFeEIsTUFBTSxtQkFBbUIs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QUFJLGVBQWUsS0FBSyxVQUFVLEVBQUU7WUFDekMsT0FBTyxnQkFBVSxDQUFDLE9BQU8sQ0FBQztTQUMzQjthQUFNO1lBQ0wsT0FBTyxJQUFJLENBQUM7U0FDYjtJQUNILENBQUM7Q0FDRjtBQXhJRCw4Q0F3SUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IFRoZSBPcGVuVGVsZW1ldHJ5IEF1dGhvcnNcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwczovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBDb250ZXh0LFxuICBIdHRwVGV4dFByb3BhZ2F0b3IsXG4gIFNwYW5Db250ZXh0LFxuICBUcmFjZUZsYWdzLFxuICBTZXR0ZXJGdW5jdGlvbixcbiAgR2V0dGVyRnVuY3Rpb24sXG4gIElOVkFMSURfVFJBQ0VfSUQsXG4gIElOVkFMSURfU1BBTl9JRCxcbn0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvYXBpJztcbmltcG9ydCB7XG4gIGdldFBhcmVudFNwYW5Db250ZXh0LFxuICBzZXRFeHRyYWN0ZWRTcGFuQ29udGV4dCxcbiAgSU5WQUxJRF9TUEFOX0NPTlRFWFQsXG4gIGlzVmFsaWQsXG59IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2NvcmUnO1xuXG5leHBvcnQgY29uc3QgQVdTWFJBWV9UUkFDRV9JRF9IRUFERVIgPSAnWC1BbXpuLVRyYWNlLUlkJztcblxuY29uc3QgVFJBQ0VfSEVBREVSX0RFTElNSVRFUiA9ICc7JztcbmNvbnN0IEtWX0RFTElNSVRFUiA9ICc9JztcblxuY29uc3QgVFJBQ0VfSURfS0VZID0gJ1Jvb3QnO1xuY29uc3QgVFJBQ0VfSURfTEVOR1RIID0gMzU7XG5jb25zdCBUUkFDRV9JRF9WRVJTSU9OID0gXCIxXCI7XG5jb25zdCBUUkFDRV9JRF9ERUxJTUlURVIgPSAnLSc7XG5jb25zdCBUUkFDRV9JRF9ERUxJTUlURVJfSU5ERVhfMSA9IDE7XG5jb25zdCBUUkFDRV9JRF9ERUxJTUlURVJfSU5ERVhfMiA9IDEwO1xuY29uc3QgVFJBQ0VfSURfRklSU1RfUEFSVF9MRU5HVEggPSA4O1xuXG5jb25zdCBQQVJFTlRfSURfS0VZID0gJ1BhcmVudCc7XG5jb25zdCBQQVJFTlRfSURfTEVOR1RIID0gMTY7XG5cbmNvbnN0IFNBTVBMRURfRkxBR19LRVkgPSAnU2FtcGxlZCc7XG5jb25zdCBTQU1QTEVEX0ZMQUdfTEVOR1RIID0gMTtcbmNvbnN0IElTX1NBTVBMRUQgPSAnMSc7XG5jb25zdCBOT1RfU0FNUExFRCA9ICcwJztcblxuY29uc3QgVkFMSURfVFJBQ0VJRF9SRUdFWCA9IC9eKFswLTlhLWZdezMyfSkkL2k7XG5jb25zdCBWQUxJRF9TUEFOSURfUkVHRVggPSAvXlswLTlhLWZdezE2fSQvaTtcbi8qKlxuICogSW1wbGVtZW50YXRpb24gb2YgdGhlIEFXUyBYLVJheSBUcmFjZSBIZWFkZXIgcHJvcGFnYXRpb24gcHJvdG9jb2wuIFNlZSA8YSBocmVmPVxuICogaHR0cHM6Ly9odHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20veHJheS9sYXRlc3QvZGV2Z3VpZGUveHJheS1jb25jZXB0cy5odG1sI3hyYXktY29uY2VwdHMtdHJhY2luZ2hlYWRlcj5BV1NcbiAqIFRyYWNpbmcgaGVhZGVyIHNwZWM8L2E+XG4gKiBcbiAqIEFuIGV4YW1wbGUgQVdTIFhyYXkgVHJhY2luZyBIZWFkZXIgaXMgc2hvd24gYmVsb3c6XG4gKiBYLUFtem4tVHJhY2UtSWQ6IFJvb3Q9MS01NzU5ZTk4OC1iZDg2MmUzZmUxYmU0NmE5OTQyNzI3OTM7UGFyZW50PTUzOTk1YzNmNDJjZDhhZDg7U2FtcGxlZD0xXG4gKi9cbmV4cG9ydCBjbGFzcyBBV1NYUmF5UHJvcGFnYXRvciBpbXBsZW1lbnRzIEh0dHBUZXh0UHJvcGFnYXRvciB7XG4gIGluamVjdChjb250ZXh0OiBDb250ZXh0LCBjYXJyaWVyOiB1bmtub3duLCBzZXR0ZXI6IFNldHRlckZ1bmN0aW9uKSB7XG4gICAgY29uc3Qgc3BhbkNvbnRleHQgPSBnZXRQYXJlbnRTcGFuQ29udGV4dChjb250ZXh0KTtcbiAgICBpZiAoIXNwYW5Db250ZXh0IHx8ICFpc1ZhbGlkKHNwYW5Db250ZXh0KSkgcmV0dXJuO1xuICAgIGlmICghVkFMSURfVFJBQ0VJRF9SRUdFWC50ZXN0KHNwYW5Db250ZXh0LnRyYWNlSWQpIHx8XG4gICAgICAhVkFMSURfU1BBTklEX1JFR0VYLnRlc3Qoc3BhbkNvbnRleHQuc3BhbklkKSB8fFxuICAgICAgIShzcGFuQ29udGV4dC50cmFjZUZsYWdzICE9PSBUcmFjZUZsYWdzLk5PTkUgJiZcbiAgICAgICAgc3BhbkNvbnRleHQudHJhY2VGbGFncyAhPT0gVHJhY2VGbGFncy5TQU1QTEVEKSkgcmV0dXJuO1xuXG4gICAgY29uc3Qgb3RUcmFjZUlkID0gc3BhbkNvbnRleHQudHJhY2VJZDtcbiAgICBjb25zdCB4cmF5VHJhY2VJZCA9IFRSQUNFX0lEX1ZFUlNJT05cbiAgICAgICsgVFJBQ0VfSURfREVMSU1JVEVSXG4gICAgICArIG90VHJhY2VJZC5zdWJzdHJpbmcoMCwgVFJBQ0VfSURfRklSU1RfUEFSVF9MRU5HVEgpXG4gICAgICArIFRSQUNFX0lEX0RFTElNSVRFUlxuICAgICAgKyBvdFRyYWNlSWQuc3Vic3RyaW5nKFRSQUNFX0lEX0ZJUlNUX1BBUlRfTEVOR1RIKTtcbiAgICBjb25zdCBwYXJlbnRJZCA9IHNwYW5Db250ZXh0LnNwYW5JZDtcbiAgICBjb25zdCBzYW1wbGluZ0ZsYWcgPSBzcGFuQ29udGV4dC50cmFjZUZsYWdzPyBJU19TQU1QTEVEOiBOT1RfU0FNUExFRDtcbiAgICAvLyBUT0RPOiBBZGQgT1QgdHJhY2Ugc3RhdGUgdG8gdGhlIFgtUmF5IHRyYWNlIGhlYWRlclxuXG4gICAgY29uc3QgdHJhY2VIZWFkZXIgPSBUUkFDRV9JRF9LRVlcbiAgICAgICsgS1ZfREVMSU1JVEVSXG4gICAgICArIHhyYXlUcmFjZUlkXG4gICAgICArIFRSQUNFX0hFQURFUl9ERUxJTUlURVJcbiAgICAgICsgUEFSRU5UX0lEX0tFWVxuICAgICAgKyBLVl9ERUxJTUlURVJcbiAgICAgICsgcGFyZW50SWRcbiAgICAgICsgVFJBQ0VfSEVBREVSX0RFTElNSVRFUlxuICAgICAgKyBTQU1QTEVEX0ZMQUdfS0VZXG4gICAgICArIEtWX0RFTElNSVRFUlxuICAgICAgKyBzYW1wbGluZ0ZsYWc7XG5cbiAgICBzZXR0ZXIoXG4gICAgICBjYXJyaWVyLFxuICAgICAgQVdTWFJBWV9UUkFDRV9JRF9IRUFERVIsXG4gICAgICB0cmFjZUhlYWRlclxuICAgICk7XG4gIH1cblxuICBleHRyYWN0KGNvbnRleHQ6IENvbnRleHQsIGNhcnJpZXI6IHVua25vd24sIGdldHRlcjogR2V0dGVyRnVuY3Rpb24pOiBDb250ZXh0IHtcbiAgICBjb25zdCBzcGFuQ29udGV4dCA9IHRoaXMuZ2V0U3BhbkNvbnRleHRGcm9tSGVhZGVyKGNhcnJpZXIsIGdldHRlcik7XG4gICAgaWYgKCFpc1ZhbGlkKHNwYW5Db250ZXh0KSkgcmV0dXJuIGNvbnRleHQ7XG5cbiAgICByZXR1cm4gc2V0RXh0cmFjdGVkU3BhbkNvbnRleHQoY29udGV4dCwgc3BhbkNvbnRleHQpO1xuICB9XG4gIFxuICBwcml2YXRlIGdldFNwYW5Db250ZXh0RnJvbUhlYWRlcihjYXJyaWVyOiB1bmtub3duLCBnZXR0ZXI6IEdldHRlckZ1bmN0aW9uKTogU3BhbkNvbnRleHQge1xuICAgIGNvbnN0IHRyYWNlSGVhZGVyID0gZ2V0dGVyKGNhcnJpZXIsIEFXU1hSQVlfVFJBQ0VfSURfSEVBREVSKTtcbiAgICAvLyBPbmx5IGlmIHRoZSByZXR1cm5lZCB0cmFjZUhlYWRlciBpcyBubyBlbXB0eSBzdHJpbmcgY2FuIGJlIGV4dHJhY3RlZFxuICAgIGlmICghdHJhY2VIZWFkZXIgfHwgdHlwZW9mIHRyYWNlSGVhZGVyICE9PSAnc3RyaW5nJykgcmV0dXJuIElOVkFMSURfU1BBTl9DT05URVhUO1xuXG4gICAgbGV0IHBvcyA9IDAsIHRyaW1tZWRQYXJ0OiBzdHJpbmc7XG4gICAgbGV0IHBhcnNlZFRyYWNlSWQgPSBJTlZBTElEX1RSQUNFX0lEO1xuICAgIGxldCBwYXJzZWRTcGFuSWQgPSBJTlZBTElEX1NQQU5fSUQ7XG4gICAgbGV0IHBhcnNlZFRyYWNlRmxhZ3MgPSBudWxsO1xuICAgIHdoaWxlKHBvcyA8IHRyYWNlSGVhZGVyLmxlbmd0aCkge1xuICAgICAgY29uc3QgZGVsaW1pdGVySW5kZXggPSB0cmFjZUhlYWRlci5pbmRleE9mKFRSQUNFX0hFQURFUl9ERUxJTUlURVIsIHBvcyk7XG4gICAgICBpZiAoZGVsaW1pdGVySW5kZXggPj0gMCkge1xuICAgICAgICB0cmltbWVkUGFydCA9IHRyYWNlSGVhZGVyLnN1YnN0cmluZyhwb3MsIGRlbGltaXRlckluZGV4KS50cmltKCk7XG4gICAgICAgIHBvcyA9IGRlbGltaXRlckluZGV4ICsgMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vbGFzdCBwYXJ0XG4gICAgICAgIHRyaW1tZWRQYXJ0ID0gdHJhY2VIZWFkZXIuc3Vic3RyaW5nKHBvcykudHJpbSgpO1xuICAgICAgICBwb3MgPSB0cmFjZUhlYWRlci5sZW5ndGg7XG4gICAgICB9XG4gICAgICBjb25zdCBlcXVhbHNJbmRleCA9IHRyaW1tZWRQYXJ0LmluZGV4T2YoS1ZfREVMSU1JVEVSKTtcblxuICAgICAgY29uc3QgdmFsdWUgPSB0cmltbWVkUGFydC5zdWJzdHJpbmcoZXF1YWxzSW5kZXggKyAxKTtcblxuICAgICAgaWYgKHRyaW1tZWRQYXJ0LnN0YXJ0c1dpdGgoVFJBQ0VfSURfS0VZKSkge1xuICAgICAgICBwYXJzZWRUcmFjZUlkID0gdGhpcy5fcGFyc2VUcmFjZUlkKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmICh0cmltbWVkUGFydC5zdGFydHNXaXRoKFBBUkVOVF9JRF9LRVkpKSB7XG4gICAgICAgIHBhcnNlZFNwYW5JZCA9IHRoaXMuX3BhcnNlU3BhbklkKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmICh0cmltbWVkUGFydC5zdGFydHNXaXRoKFNBTVBMRURfRkxBR19LRVkpKSB7XG4gICAgICAgIHBhcnNlZFRyYWNlRmxhZ3MgPSB0aGlzLl9wYXJzZVRyYWNlRmxhZyh2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChwYXJzZWRUcmFjZUZsYWdzID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gSU5WQUxJRF9TUEFOX0NPTlRFWFQ7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdFNwYW5Db250ZXh0OiBTcGFuQ29udGV4dCA9IHtcbiAgICAgIHRyYWNlSWQ6IHBhcnNlZFRyYWNlSWQsXG4gICAgICBzcGFuSWQ6IHBhcnNlZFNwYW5JZCxcbiAgICAgIHRyYWNlRmxhZ3M6IHBhcnNlZFRyYWNlRmxhZ3MsXG4gICAgICBpc1JlbW90ZTogdHJ1ZSxcbiAgICB9XG4gICAgaWYgKCFpc1ZhbGlkKHJlc3VsdFNwYW5Db250ZXh0KSkge1xuICAgICAgcmV0dXJuIElOVkFMSURfU1BBTl9DT05URVhUO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0U3BhbkNvbnRleHQ7XG4gIH1cblxuICBwcml2YXRlIF9wYXJzZVRyYWNlSWQoeHJheVRyYWNlSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gQ2hlY2sgbGVuZ3RoIG9mIHRyYWNlIGlkXG4gICAgaWYgKHhyYXlUcmFjZUlkLmxlbmd0aCAhPT0gVFJBQ0VfSURfTEVOR1RIKSB7XG4gICAgICByZXR1cm4gSU5WQUxJRF9UUkFDRV9JRDtcbiAgICB9XG5cbiAgICAvLyBDaGVjayB2ZXJzaW9uIHRyYWNlIGlkIHZlcnNpb25cbiAgICBpZiAoIXhyYXlUcmFjZUlkLnN0YXJ0c1dpdGgoVFJBQ0VfSURfVkVSU0lPTikpIHtcbiAgICAgIHJldHVybiBJTlZBTElEX1RSQUNFX0lEO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGRlbGltaXRlcnNcbiAgICBpZiAoeHJheVRyYWNlSWQuY2hhckF0KFRSQUNFX0lEX0RFTElNSVRFUl9JTkRFWF8xKSAhPT0gVFJBQ0VfSURfREVMSU1JVEVSXG4gICAgfHwgeHJheVRyYWNlSWQuY2hhckF0KFRSQUNFX0lEX0RFTElNSVRFUl9JTkRFWF8yKSAhPT0gVFJBQ0VfSURfREVMSU1JVEVSKSB7XG4gICAgICByZXR1cm4gSU5WQUxJRF9UUkFDRV9JRDtcbiAgICB9XG5cbiAgICBjb25zdCBlcG9jaFBhcnQgPSB4cmF5VHJhY2VJZC5zdWJzdHJpbmcoVFJBQ0VfSURfREVMSU1JVEVSX0lOREVYXzEgKyAxLCBUUkFDRV9JRF9ERUxJTUlURVJfSU5ERVhfMik7XG4gICAgY29uc3QgdW5pcXVlUGFydCA9IHhyYXlUcmFjZUlkLnN1YnN0cmluZyhUUkFDRV9JRF9ERUxJTUlURVJfSU5ERVhfMiArIDEsIFRSQUNFX0lEX0xFTkdUSCk7XG4gICAgY29uc3QgcmVzVHJhY2VJZCA9IGVwb2NoUGFydCArIHVuaXF1ZVBhcnQ7XG5cbiAgICAvLyBDaGVjayB0aGUgY29udGVudCBvZiB0cmFjZSBpZFxuICAgIGlmICghVkFMSURfVFJBQ0VJRF9SRUdFWC50ZXN0KHJlc1RyYWNlSWQpKSB7XG4gICAgICByZXR1cm4gSU5WQUxJRF9UUkFDRV9JRFxuICAgIH1cblxuICAgIHJldHVybiByZXNUcmFjZUlkO1xuICB9XG5cbiAgcHJpdmF0ZSBfcGFyc2VTcGFuSWQoeHJheVBhcmVudElkOiBzdHJpbmcpOiBzdHJpbmd7XG4gICAgcmV0dXJuICh4cmF5UGFyZW50SWQubGVuZ3RoID09PSBQQVJFTlRfSURfTEVOR1RIICYmIFxuICAgICAgVkFMSURfU1BBTklEX1JFR0VYLnRlc3QoeHJheVBhcmVudElkKSk/IHhyYXlQYXJlbnRJZDogSU5WQUxJRF9TUEFOX0lEO1xuICB9XG5cbiAgcHJpdmF0ZSBfcGFyc2VUcmFjZUZsYWcoeHJheVNhbXBsZWRGbGFnOiBzdHJpbmcpOiBUcmFjZUZsYWdzIHwgbnVsbCB7XG4gICAgaWYgKHhyYXlTYW1wbGVkRmxhZy5sZW5ndGggPT09IFNBTVBMRURfRkxBR19MRU5HVEggJiYgeHJheVNhbXBsZWRGbGFnID09PSBOT1RfU0FNUExFRCkge1xuICAgICAgcmV0dXJuIFRyYWNlRmxhZ3MuTk9ORTtcbiAgICB9IGVsc2UgaWYgKHhyYXlTYW1wbGVkRmxhZyA9PT0gSVNfU0FNUExFRCkge1xuICAgICAgcmV0dXJuIFRyYWNlRmxhZ3MuU0FNUExFRDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy96b2NvbmcvRG9jdW1lbnRzL2ZvcmtlZC9vcGVudGVsZW1ldHJ5LWpzLWNvbnRyaWIvcHJvcGFnYXRvcnMvb3BlbnRlbGVtZXRyeS1wcm9wYWdhdG9yLWF3cy14cmF5L3NyYy9BV1NYUmF5UHJvcGFnYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiYUFBQTs7Ozs7Ozs7Ozs7Ozs7OHl1QkFjRztxUUFFSCxLQUFBLENBQUEsS0FBQSwwQkFBQSxPQUFBLENBQUEsb0JBQUEsQ0FBQSxDQUFBLENBVUEsS0FBQSxDQUFBLE1BQUEsMEJBQUEsT0FBQSxDQUFBLHFCQUFBLENBQUEsQ0FBQSxDLHdCQU9hLE9BQUEsQ0FBQSx1QkFBQSxDQUEwQixpQkFBMUIsQ0FFYixLQUFNLENBQUEsc0JBQXNCLDBCQUFHLEdBQUgsQ0FBNUIsQ0FDQSxLQUFNLENBQUEsWUFBWSwwQkFBRyxHQUFILENBQWxCLENBRUEsS0FBTSxDQUFBLFlBQVksMEJBQUcsTUFBSCxDQUFsQixDQUNBLEtBQU0sQ0FBQSxlQUFlLDBCQUFHLEVBQUgsQ0FBckIsQ0FDQSxLQUFNLENBQUEsZ0JBQWdCLDBCQUFHLEdBQUgsQ0FBdEIsQ0FDQSxLQUFNLENBQUEsa0JBQWtCLDJCQUFHLEdBQUgsQ0FBeEIsQ0FDQSxLQUFNLENBQUEsMEJBQTBCLDJCQUFHLENBQUgsQ0FBaEMsQ0FDQSxLQUFNLENBQUEsMEJBQTBCLDJCQUFHLEVBQUgsQ0FBaEMsQ0FDQSxLQUFNLENBQUEsMEJBQTBCLDJCQUFHLENBQUgsQ0FBaEMsQ0FFQSxLQUFNLENBQUEsYUFBYSwyQkFBRyxRQUFILENBQW5CLENBQ0EsS0FBTSxDQUFBLGdCQUFnQiwyQkFBRyxFQUFILENBQXRCLENBRUEsS0FBTSxDQUFBLGdCQUFnQiwyQkFBRyxTQUFILENBQXRCLENBQ0EsS0FBTSxDQUFBLG1CQUFtQiwyQkFBRyxDQUFILENBQXpCLENBQ0EsS0FBTSxDQUFBLFVBQVUsMkJBQUcsR0FBSCxDQUFoQixDQUNBLEtBQU0sQ0FBQSxXQUFX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QkFBdEQsQ0FBSCxDQUFmLENBQ0EsS0FBTSxDQUFBLFVBQVUsMkJBQUcsV0FBVyxDQUFDLFNBQVosQ0FBc0IsMEJBQTBCLENBQUcsQ0FBbkQsQ0FBc0QsZUFBdEQsQ0FBSCxDQUFoQixDQUNBLEtBQU0sQ0FBQSxVQUFVLDJCQUFHLFNBQVMsQ0FBRyxVQUFmLENBQWhCLENBRUE7QUFyQnVDLHlCQXNCdkMsR0FBSSxDQUFDLG1CQUFtQixDQUFDLElBQXBCLENBQXlCLFVBQXpCLENBQUwsQ0FBMkMsc0RBQ3pDLE1BQU8sQ0FBQSxLQUFBLENBQUEsZ0JBQVAsQ0FDRCxDQUZELGtDQXRCdUMseUJBMEJ2QyxNQUFPLENBQUEsVUFBUCxDQUNELENBRU8sWUFBWSxDQUFDLFlBQUQsQ0FBcUIsa0RBQ3ZDLE1BQVEsNkJBQUEsWUFBWSxDQUFDLE1BQWIsR0FBd0IsZ0JBQXhCLGdDQUNOLGtCQUFrQixDQUFDLElBQW5CLENBQXdCLFlBQXhCLENBRE0sQ0FBRCw4QkFDbUMsWUFEbkMsK0JBQ2lELEtBQUEsQ0FBQSxlQURqRCxDQUFQLENBRUQsQ0FFTyxlQUFlLENBQUMsZUFBRCxDQUF3QixrREFDN0MsR0FBSSw2QkFBQSxlQUFlLENBQUMsTUFBaEIsR0FBMkIsbUJBQTNCLGdDQUFrRCxlQUFlLEdBQUssV0FBdEUsQ0FBSixDQUF1RixzREFDckYsTUFBTyxDQUFBLEtBQUEsQ0FBQSxVQUFBLENBQVcsSUFBbEIsQ0FDRCxDQUZELElBRU8seURBQUksZUFBZSxHQUFLLFVBQXhCLENBQW9DLHNEQUN6QyxNQUFPLENBQUEsS0FBQSxDQUFBLFVBQUEsQ0FBVyxPQUFsQixDQUNELENBRk0sSUFFQSxzREFDTCxNQUFPLEtBQVAsQ0FDRCxFQUNGLENBdkkyQixDLHlCQUE5QixPQUFBLENBQUEsaUJBQUEsQ0FBQSxpQkFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCBUaGUgT3BlblRlbGVtZXRyeSBBdXRob3JzXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cHM6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgQ29udGV4dCxcbiAgSHR0cFRleHRQcm9wYWdhdG9yLFxuICBTcGFuQ29udGV4dCxcbiAgVHJhY2VGbGFncyxcbiAgU2V0dGVyRnVuY3Rpb24sXG4gIEdldHRlckZ1bmN0aW9uLFxuICBJTlZBTElEX1RSQUNFX0lELFxuICBJTlZBTElEX1NQQU5fSUQsXG59IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2FwaSc7XG5pbXBvcnQge1xuICBnZXRQYXJlbnRTcGFuQ29udGV4dCxcbiAgc2V0RXh0cmFjdGVkU3BhbkNvbnRleHQsXG4gIElOVkFMSURfU1BBTl9DT05URVhULFxuICBpc1ZhbGlkLFxufSBmcm9tICdAb3BlbnRlbGVtZXRyeS9jb3JlJztcblxuZXhwb3J0IGNvbnN0IEFXU1hSQVlfVFJBQ0VfSURfSEVBREVSID0gJ1gtQW16bi1UcmFjZS1JZCc7XG5cbmNvbnN0IFRSQUNFX0hFQURFUl9ERUxJTUlURVIgPSAnOyc7XG5jb25zdCBLVl9ERUxJTUlURVIgPSAnPSc7XG5cbmNvbnN0IFRSQUNFX0lEX0tFWSA9ICdSb290JztcbmNvbnN0IFRSQUNFX0lEX0xFTkdUSCA9IDM1O1xuY29uc3QgVFJBQ0VfSURfVkVSU0lPTiA9IFwiMVwiO1xuY29uc3QgVFJBQ0VfSURfREVMSU1JVEVSID0gJy0nO1xuY29uc3QgVFJBQ0VfSURfREVMSU1JVEVSX0lOREVYXzEgPSAxO1xuY29uc3QgVFJBQ0VfSURfREVMSU1JVEVSX0lOREVYXzIgPSAxMDtcbmNvbnN0IFRSQUNFX0lEX0ZJUlNUX1BBUlRfTEVOR1RIID0gODtcblxuY29uc3QgUEFSRU5UX0lEX0tFWSA9ICdQYXJlbnQnO1xuY29uc3QgUEFSRU5UX0lEX0xFTkdUSCA9IDE2O1xuXG5jb25zdCBTQU1QTEVEX0ZMQUdfS0VZID0gJ1NhbXBsZWQnO1xuY29uc3QgU0FNUExFRF9GTEFHX0xFTkdUSCA9IDE7XG5jb25zdCBJU19TQU1QTEVEID0gJzEnO1xuY29uc3QgTk9UX1NBTVBMRUQgPSAnMCc7XG5cbmNvbnN0IFZBTElEX1RSQUNFSURfUkVHRVggPSAvXihbMC05YS1mXXszMn0pJC9pO1xuY29uc3QgVkFMSURfU1BBTklEX1JFR0VYID0gL15bMC05YS1mXXsxNn0kL2k7XG4vKipcbiAqIEltcGxlbWVudGF0aW9uIG9mIHRoZSBBV1MgWC1SYXkgVHJhY2UgSGVhZGVyIHByb3BhZ2F0aW9uIHByb3RvY29sLiBTZWUgPGEgaHJlZj1cbiAqIGh0dHBzOi8vaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL3hyYXkvbGF0ZXN0L2Rldmd1aWRlL3hyYXktY29uY2VwdHMuaHRtbCN4cmF5LWNvbmNlcHRzLXRyYWNpbmdoZWFkZXI+QVdTXG4gKiBUcmFjaW5nIGhlYWRlciBzcGVjPC9hPlxuICogXG4gKiBBbiBleGFtcGxlIEFXUyBYcmF5IFRyYWNpbmcgSGVhZGVyIGlzIHNob3duIGJlbG93OlxuICogWC1BbXpuLVRyYWNlLUlkOiBSb290PTEtNTc1OWU5ODgtYmQ4NjJlM2ZlMWJlNDZhOTk0MjcyNzkzO1BhcmVudD01Mzk5NWMzZjQyY2Q4YWQ4O1NhbXBsZWQ9MVxuICovXG5leHBvcnQgY2xhc3MgQVdTWFJheVByb3BhZ2F0b3IgaW1wbGVtZW50cyBIdHRwVGV4dFByb3BhZ2F0b3Ige1xuICBpbmplY3QoY29udGV4dDogQ29udGV4dCwgY2FycmllcjogdW5rbm93biwgc2V0dGVyOiBTZXR0ZXJGdW5jdGlvbikge1xuICAgIGNvbnN0IHNwYW5Db250ZXh0ID0gZ2V0UGFyZW50U3BhbkNvbnRleHQoY29udGV4dCk7XG4gICAgaWYgKCFzcGFuQ29udGV4dCB8fCAhaXNWYWxpZChzcGFuQ29udGV4dCkpIHJldHVybjtcbiAgICBpZiAoIVZBTElEX1RSQUNFSURfUkVHRVgudGVzdChzcGFuQ29udGV4dC50cmFjZUlkKSB8fFxuICAgICAgIVZBTElEX1NQQU5JRF9SRUdFWC50ZXN0KHNwYW5Db250ZXh0LnNwYW5JZCkgfHxcbiAgICAgICEoc3BhbkNvbnRleHQudHJhY2VGbGFncyAhPT0gVHJhY2VGbGFncy5OT05FICYmXG4gICAgICAgIHNwYW5Db250ZXh0LnRyYWNlRmxhZ3MgIT09IFRyYWNlRmxhZ3MuU0FNUExFRCkpIHJldHVybjtcblxuICAgIGNvbnN0IG90VHJhY2VJZCA9IHNwYW5Db250ZXh0LnRyYWNlSWQ7XG4gICAgY29uc3QgeHJheVRyYWNlSWQgPSBUUkFDRV9JRF9WRVJTSU9OXG4gICAgICArIFRSQUNFX0lEX0RFTElNSVRFUlxuICAgICAgKyBvdFRyYWNlSWQuc3Vic3RyaW5nKDAsIFRSQUNFX0lEX0ZJUlNUX1BBUlRfTEVOR1RIKVxuICAgICAgKyBUUkFDRV9JRF9ERUxJTUlURVJcbiAgICAgICsgb3RUcmFjZUlkLnN1YnN0cmluZyhUUkFDRV9JRF9GSVJTVF9QQVJUX0xFTkdUSCk7XG4gICAgY29uc3QgcGFyZW50SWQgPSBzcGFuQ29udGV4dC5zcGFuSWQ7XG4gICAgY29uc3Qgc2FtcGxpbmdGbGFnID0gc3BhbkNvbnRleHQudHJhY2VGbGFncz8gSVNfU0FNUExFRDogTk9UX1NBTVBMRUQ7XG4gICAgLy8gVE9ETzogQWRkIE9UIHRyYWNlIHN0YXRlIHRvIHRoZSBYLVJheSB0cmFjZSBoZWFkZXJcblxuICAgIGNvbnN0IHRyYWNlSGVhZGVyID0gVFJBQ0VfSURfS0VZXG4gICAgICArIEtWX0RFTElNSVRFUlxuICAgICAgKyB4cmF5VHJhY2VJZFxuICAgICAgKyBUUkFDRV9IRUFERVJfREVMSU1JVEVSXG4gICAgICArIFBBUkVOVF9JRF9LRVlcbiAgICAgICsgS1ZfREVMSU1JVEVSXG4gICAgICArIHBhcmVudElkXG4gICAgICArIFRSQUNFX0hFQURFUl9ERUxJTUlURVJcbiAgICAgICsgU0FNUExFRF9GTEFHX0tFWVxuICAgICAgKyBLVl9ERUxJTUlURVJcbiAgICAgICsgc2FtcGxpbmdGbGFnO1xuXG4gICAgc2V0dGVyKFxuICAgICAgY2FycmllcixcbiAgICAgIEFXU1hSQVlfVFJBQ0VfSURfSEVBREVSLFxuICAgICAgdHJhY2VIZWFkZXJcbiAgICApO1xuICB9XG5cbiAgZXh0cmFjdChjb250ZXh0OiBDb250ZXh0LCBjYXJyaWVyOiB1bmtub3duLCBnZXR0ZXI6IEdldHRlckZ1bmN0aW9uKTogQ29udGV4dCB7XG4gICAgY29uc3Qgc3BhbkNvbnRleHQgPSB0aGlzLmdldFNwYW5Db250ZXh0RnJvbUhlYWRlcihjYXJyaWVyLCBnZXR0ZXIpO1xuICAgIGlmICghaXNWYWxpZChzcGFuQ29udGV4dCkpIHJldHVybiBjb250ZXh0O1xuXG4gICAgcmV0dXJuIHNldEV4dHJhY3RlZFNwYW5Db250ZXh0KGNvbnRleHQsIHNwYW5Db250ZXh0KTtcbiAgfVxuICBcbiAgcHJpdmF0ZSBnZXRTcGFuQ29udGV4dEZyb21IZWFkZXIoY2FycmllcjogdW5rbm93biwgZ2V0dGVyOiBHZXR0ZXJGdW5jdGlvbik6IFNwYW5Db250ZXh0IHtcbiAgICBjb25zdCB0cmFjZUhlYWRlciA9IGdldHRlcihjYXJyaWVyLCBBV1NYUkFZX1RSQUNFX0lEX0hFQURFUik7XG4gICAgLy8gT25seSBpZiB0aGUgcmV0dXJuZWQgdHJhY2VIZWFkZXIgaXMgbm8gZW1wdHkgc3RyaW5nIGNhbiBiZSBleHRyYWN0ZWRcbiAgICBpZiAoIXRyYWNlSGVhZGVyIHx8IHR5cGVvZiB0cmFjZUhlYWRlciAhPT0gJ3N0cmluZycpIHJldHVybiBJTlZBTElEX1NQQU5fQ09OVEVYVDtcblxuICAgIGxldCBwb3MgPSAwLCB0cmltbWVkUGFydDogc3RyaW5nO1xuICAgIGxldCBwYXJzZWRUcmFjZUlkID0gSU5WQUxJRF9UUkFDRV9JRDtcbiAgICBsZXQgcGFyc2VkU3BhbklkID0gSU5WQUxJRF9TUEFOX0lEO1xuICAgIGxldCBwYXJzZWRUcmFjZUZsYWdzID0gbnVsbDtcbiAgICB3aGlsZShwb3MgPCB0cmFjZUhlYWRlci5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGRlbGltaXRlckluZGV4ID0gdHJhY2VIZWFkZXIuaW5kZXhPZihUUkFDRV9IRUFERVJfREVMSU1JVEVSLCBwb3MpO1xuICAgICAgaWYgKGRlbGltaXRlckluZGV4ID49IDApIHtcbiAgICAgICAgdHJpbW1lZFBhcnQgPSB0cmFjZUhlYWRlci5zdWJzdHJpbmcocG9zLCBkZWxpbWl0ZXJJbmRleCkudHJpbSgpO1xuICAgICAgICBwb3MgPSBkZWxpbWl0ZXJJbmRleCArIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL2xhc3QgcGFydFxuICAgICAgICB0cmltbWVkUGFydCA9IHRyYWNlSGVhZGVyLnN1YnN0cmluZyhwb3MpLnRyaW0oKTtcbiAgICAgICAgcG9zID0gdHJhY2VIZWFkZXIubGVuZ3RoO1xuICAgICAgfVxuICAgICAgY29uc3QgZXF1YWxzSW5kZXggPSB0cmltbWVkUGFydC5pbmRleE9mKEtWX0RFTElNSVRFUik7XG5cbiAgICAgIGNvbnN0IHZhbHVlID0gdHJpbW1lZFBhcnQuc3Vic3RyaW5nKGVxdWFsc0luZGV4ICsgMSk7XG5cbiAgICAgIGlmICh0cmltbWVkUGFydC5zdGFydHNXaXRoKFRSQUNFX0lEX0tFWSkpIHtcbiAgICAgICAgcGFyc2VkVHJhY2VJZCA9IHRoaXMuX3BhcnNlVHJhY2VJZCh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodHJpbW1lZFBhcnQuc3RhcnRzV2l0aChQQVJFTlRfSURfS0VZKSkge1xuICAgICAgICBwYXJzZWRTcGFuSWQgPSB0aGlzLl9wYXJzZVNwYW5JZCh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodHJpbW1lZFBhcnQuc3RhcnRzV2l0aChTQU1QTEVEX0ZMQUdfS0VZKSkge1xuICAgICAgICBwYXJzZWRUcmFjZUZsYWdzID0gdGhpcy5fcGFyc2VUcmFjZUZsYWcodmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAocGFyc2VkVHJhY2VGbGFncyA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIElOVkFMSURfU1BBTl9DT05URVhUO1xuICAgIH1cbiAgICBjb25zdCByZXN1bHRTcGFuQ29udGV4dDogU3BhbkNvbnRleHQgPSB7XG4gICAgICB0cmFjZUlkOiBwYXJzZWRUcmFjZUlkLFxuICAgICAgc3BhbklkOiBwYXJzZWRTcGFuSWQsXG4gICAgICB0cmFjZUZsYWdzOiBwYXJzZWRUcmFjZUZsYWdzLFxuICAgICAgaXNSZW1vdGU6IHRydWUsXG4gICAgfVxuICAgIGlmICghaXNWYWxpZChyZXN1bHRTcGFuQ29udGV4dCkpIHtcbiAgICAgIHJldHVybiBJTlZBTElEX1NQQU5fQ09OVEVYVDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdFNwYW5Db250ZXh0O1xuICB9XG5cbiAgcHJpdmF0ZSBfcGFyc2VUcmFjZUlkKHhyYXlUcmFjZUlkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIENoZWNrIGxlbmd0aCBvZiB0cmFjZSBpZFxuICAgIGlmICh4cmF5VHJhY2VJZC5sZW5ndGggIT09IFRSQUNFX0lEX0xFTkdUSCkge1xuICAgICAgcmV0dXJuIElOVkFMSURfVFJBQ0VfSUQ7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgdmVyc2lvbiB0cmFjZSBpZCB2ZXJzaW9uXG4gICAgaWYgKCF4cmF5VHJhY2VJZC5zdGFydHNXaXRoKFRSQUNFX0lEX1ZFUlNJT04pKSB7XG4gICAgICByZXR1cm4gSU5WQUxJRF9UUkFDRV9JRDtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBkZWxpbWl0ZXJzXG4gICAgaWYgKHhyYXlUcmFjZUlkLmNoYXJBdChUUkFDRV9JRF9ERUxJTUlURVJfSU5ERVhfMSkgIT09IFRSQUNFX0lEX0RFTElNSVRFUlxuICAgIHx8IHhyYXlUcmFjZUlkLmNoYXJBdChUUkFDRV9JRF9ERUxJTUlURVJfSU5ERVhfMikgIT09IFRSQUNFX0lEX0RFTElNSVRFUikge1xuICAgICAgcmV0dXJuIElOVkFMSURfVFJBQ0VfSUQ7XG4gICAgfVxuXG4gICAgY29uc3QgZXBvY2hQYXJ0ID0geHJheVRyYWNlSWQuc3Vic3RyaW5nKFRSQUNFX0lEX0RFTElNSVRFUl9JTkRFWF8xICsgMSwgVFJBQ0VfSURfREVMSU1JVEVSX0lOREVYXzIpO1xuICAgIGNvbnN0IHVuaXF1ZVBhcnQgPSB4cmF5VHJhY2VJZC5zdWJzdHJpbmcoVFJBQ0VfSURfREVMSU1JVEVSX0lOREVYXzIgKyAxLCBUUkFDRV9JRF9MRU5HVEgpO1xuICAgIGNvbnN0IHJlc1RyYWNlSWQgPSBlcG9jaFBhcnQgKyB1bmlxdWVQYXJ0O1xuXG4gICAgLy8gQ2hlY2sgdGhlIGNvbnRlbnQgb2YgdHJhY2UgaWRcbiAgICBpZiAoIVZBTElEX1RSQUNFSURfUkVHRVgudGVzdChyZXNUcmFjZUlkKSkge1xuICAgICAgcmV0dXJuIElOVkFMSURfVFJBQ0VfSURcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzVHJhY2VJZDtcbiAgfVxuXG4gIHByaXZhdGUgX3BhcnNlU3BhbklkKHhyYXlQYXJlbnRJZDogc3RyaW5nKTogc3RyaW5ne1xuICAgIHJldHVybiAoeHJheVBhcmVudElkLmxlbmd0aCA9PT0gUEFSRU5UX0lEX0xFTkdUSCAmJiBcbiAgICAgIFZBTElEX1NQQU5JRF9SRUdFWC50ZXN0KHhyYXlQYXJlbnRJZCkpPyB4cmF5UGFyZW50SWQ6IElOVkFMSURfU1BBTl9JRDtcbiAgfVxuXG4gIHByaXZhdGUgX3BhcnNlVHJhY2VGbGFnKHhyYXlTYW1wbGVkRmxhZzogc3RyaW5nKTogVHJhY2VGbGFncyB8IG51bGwge1xuICAgIGlmICh4cmF5U2FtcGxlZEZsYWcubGVuZ3RoID09PSBTQU1QTEVEX0ZMQUdfTEVOR1RIICYmIHhyYXlTYW1wbGVkRmxhZyA9PT0gTk9UX1NBTVBMRUQpIHtcbiAgICAgIHJldHVybiBUcmFjZUZsYWdzLk5PTkU7XG4gICAgfSBlbHNlIGlmICh4cmF5U2FtcGxlZEZsYWcgPT09IElTX1NBTVBMRUQpIHtcbiAgICAgIHJldHVybiBUcmFjZUZsYWdzLlNBTVBMRUQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxufVxuIl19